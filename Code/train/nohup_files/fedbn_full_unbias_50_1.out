nohup: ignoring input
/home/jiahui/miniconda3/lib/python3.9/site-packages/requests/__init__.py:102: RequestsDependencyWarning: urllib3 (1.26.8) or chardet (5.0.0)/charset_normalizer (2.0.4) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({})/charset_normalizer ({}) doesn't match a supported "
Device: cuda
Using downloaded and verified file: /home/jiahui/FL-NeurIPS-2022/Code/datasets/../../Data/SVHN/train_32x32.mat
Using downloaded and verified file: /home/jiahui/FL-NeurIPS-2022/Code/datasets/../../Data/SVHN/test_32x32.mat
Client alpha: [0.2, 0.2, 0.2, 0.2, 0.2]
============ Communication round 0 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.2982 | Train Acc: 0.9328
 SVHN       | Train Loss: 1.2506 | Train Acc: 0.6083
 USPS       | Train Loss: 0.2193 | Train Acc: 0.9527
 SynthDigits| Train Loss: 0.8411 | Train Acc: 0.7620
 MNIST-M    | Train Loss: 0.9110 | Train Acc: 0.7324
============ Test ============
 MNIST      | Test  Loss: 2.2779 | Test  Acc: 0.2386
 SVHN       | Test  Loss: 1.7070 | Test  Acc: 0.4922
 USPS       | Test  Loss: 1.2225 | Test  Acc: 0.5989
 SynthDigits| Test  Loss: 1.7452 | Test  Acc: 0.3454
 MNIST-M    | Test  Loss: 1.5449 | Test  Acc: 0.4997
============ Communication round 1 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.1541 | Train Acc: 0.9652
 SVHN       | Train Loss: 0.8108 | Train Acc: 0.7582
 USPS       | Train Loss: 0.1140 | Train Acc: 0.9759
 SynthDigits| Train Loss: 0.4866 | Train Acc: 0.8644
 MNIST-M    | Train Loss: 0.5265 | Train Acc: 0.8491
============ Test ============
 MNIST      | Test  Loss: 0.8321 | Test  Acc: 0.7216
 SVHN       | Test  Loss: 1.1724 | Test  Acc: 0.6456
 USPS       | Test  Loss: 0.3258 | Test  Acc: 0.9188
 SynthDigits| Test  Loss: 0.9803 | Test  Acc: 0.6669
 MNIST-M    | Test  Loss: 0.9108 | Test  Acc: 0.7325
============ Communication round 2 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.1069 | Train Acc: 0.9728
 SVHN       | Train Loss: 0.6834 | Train Acc: 0.7870
 USPS       | Train Loss: 0.0843 | Train Acc: 0.9797
 SynthDigits| Train Loss: 0.3704 | Train Acc: 0.8944
 MNIST-M    | Train Loss: 0.4033 | Train Acc: 0.8755
============ Test ============
 MNIST      | Test  Loss: 0.4375 | Test  Acc: 0.8579
 SVHN       | Test  Loss: 0.8654 | Test  Acc: 0.7382
 USPS       | Test  Loss: 0.2515 | Test  Acc: 0.9327
 SynthDigits| Test  Loss: 0.6266 | Test  Acc: 0.8024
 MNIST-M    | Test  Loss: 0.6836 | Test  Acc: 0.8031
============ Communication round 3 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0875 | Train Acc: 0.9756
 SVHN       | Train Loss: 0.6015 | Train Acc: 0.8118
 USPS       | Train Loss: 0.0639 | Train Acc: 0.9827
 SynthDigits| Train Loss: 0.3088 | Train Acc: 0.9082
 MNIST-M    | Train Loss: 0.3219 | Train Acc: 0.8989
============ Test ============
 MNIST      | Test  Loss: 0.2344 | Test  Acc: 0.9262
 SVHN       | Test  Loss: 0.8343 | Test  Acc: 0.7258
 USPS       | Test  Loss: 0.2454 | Test  Acc: 0.9263
 SynthDigits| Test  Loss: 0.5215 | Test  Acc: 0.8354
 MNIST-M    | Test  Loss: 0.6106 | Test  Acc: 0.8218
============ Communication round 4 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0727 | Train Acc: 0.9804
 SVHN       | Train Loss: 0.5480 | Train Acc: 0.8264
 USPS       | Train Loss: 0.0593 | Train Acc: 0.9848
 SynthDigits| Train Loss: 0.2557 | Train Acc: 0.9265
 MNIST-M    | Train Loss: 0.2757 | Train Acc: 0.9161
============ Test ============
 MNIST      | Test  Loss: 0.1907 | Test  Acc: 0.9405
 SVHN       | Test  Loss: 0.7264 | Test  Acc: 0.7800
 USPS       | Test  Loss: 0.2319 | Test  Acc: 0.9332
 SynthDigits| Test  Loss: 0.4727 | Test  Acc: 0.8505
 MNIST-M    | Test  Loss: 0.4958 | Test  Acc: 0.8507
============ Communication round 5 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0580 | Train Acc: 0.9846
 SVHN       | Train Loss: 0.4964 | Train Acc: 0.8467
 USPS       | Train Loss: 0.0504 | Train Acc: 0.9864
 SynthDigits| Train Loss: 0.2265 | Train Acc: 0.9339
 MNIST-M    | Train Loss: 0.2388 | Train Acc: 0.9262
============ Test ============
 MNIST      | Test  Loss: 0.1401 | Test  Acc: 0.9582
 SVHN       | Test  Loss: 0.6263 | Test  Acc: 0.8066
 USPS       | Test  Loss: 0.1899 | Test  Acc: 0.9417
 SynthDigits| Test  Loss: 0.4223 | Test  Acc: 0.8646
 MNIST-M    | Test  Loss: 0.5383 | Test  Acc: 0.8294
============ Communication round 6 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0491 | Train Acc: 0.9856
 SVHN       | Train Loss: 0.4462 | Train Acc: 0.8616
 USPS       | Train Loss: 0.0408 | Train Acc: 0.9897
 SynthDigits| Train Loss: 0.1921 | Train Acc: 0.9471
 MNIST-M    | Train Loss: 0.2044 | Train Acc: 0.9423
============ Test ============
 MNIST      | Test  Loss: 0.1279 | Test  Acc: 0.9603
 SVHN       | Test  Loss: 0.6286 | Test  Acc: 0.8049
 USPS       | Test  Loss: 0.1719 | Test  Acc: 0.9477
 SynthDigits| Test  Loss: 0.3967 | Test  Acc: 0.8766
 MNIST-M    | Test  Loss: 0.4551 | Test  Acc: 0.8611
============ Communication round 7 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0471 | Train Acc: 0.9875
 SVHN       | Train Loss: 0.4115 | Train Acc: 0.8726
 USPS       | Train Loss: 0.0360 | Train Acc: 0.9908
 SynthDigits| Train Loss: 0.1747 | Train Acc: 0.9484
 MNIST-M    | Train Loss: 0.1646 | Train Acc: 0.9524
============ Test ============
 MNIST      | Test  Loss: 0.1080 | Test  Acc: 0.9665
 SVHN       | Test  Loss: 0.6023 | Test  Acc: 0.8109
 USPS       | Test  Loss: 0.1558 | Test  Acc: 0.9537
 SynthDigits| Test  Loss: 0.3514 | Test  Acc: 0.8891
 MNIST-M    | Test  Loss: 0.3983 | Test  Acc: 0.8751
============ Communication round 8 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0405 | Train Acc: 0.9886
 SVHN       | Train Loss: 0.3692 | Train Acc: 0.8836
 USPS       | Train Loss: 0.0339 | Train Acc: 0.9915
 SynthDigits| Train Loss: 0.1454 | Train Acc: 0.9619
 MNIST-M    | Train Loss: 0.1484 | Train Acc: 0.9587
============ Test ============
 MNIST      | Test  Loss: 0.0978 | Test  Acc: 0.9693
 SVHN       | Test  Loss: 0.5662 | Test  Acc: 0.8307
 USPS       | Test  Loss: 0.1587 | Test  Acc: 0.9532
 SynthDigits| Test  Loss: 0.3802 | Test  Acc: 0.8759
 MNIST-M    | Test  Loss: 0.4563 | Test  Acc: 0.8507
============ Communication round 9 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0327 | Train Acc: 0.9920
 SVHN       | Train Loss: 0.3313 | Train Acc: 0.9006
 USPS       | Train Loss: 0.0339 | Train Acc: 0.9915
 SynthDigits| Train Loss: 0.1351 | Train Acc: 0.9620
 MNIST-M    | Train Loss: 0.1208 | Train Acc: 0.9706
============ Test ============
 MNIST      | Test  Loss: 0.0700 | Test  Acc: 0.9779
 SVHN       | Test  Loss: 0.5915 | Test  Acc: 0.8240
 USPS       | Test  Loss: 0.1478 | Test  Acc: 0.9552
 SynthDigits| Test  Loss: 0.3258 | Test  Acc: 0.8963
 MNIST-M    | Test  Loss: 0.3735 | Test  Acc: 0.8782
============ Communication round 10 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0272 | Train Acc: 0.9937
 SVHN       | Train Loss: 0.3082 | Train Acc: 0.9029
 USPS       | Train Loss: 0.0292 | Train Acc: 0.9933
 SynthDigits| Train Loss: 0.1185 | Train Acc: 0.9709
 MNIST-M    | Train Loss: 0.1081 | Train Acc: 0.9727
============ Test ============
 MNIST      | Test  Loss: 0.0728 | Test  Acc: 0.9769
 SVHN       | Test  Loss: 0.5627 | Test  Acc: 0.8291
 USPS       | Test  Loss: 0.1387 | Test  Acc: 0.9606
 SynthDigits| Test  Loss: 0.3316 | Test  Acc: 0.8927
 MNIST-M    | Test  Loss: 0.3617 | Test  Acc: 0.8847
============ Communication round 11 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0258 | Train Acc: 0.9941
 SVHN       | Train Loss: 0.2658 | Train Acc: 0.9213
 USPS       | Train Loss: 0.0270 | Train Acc: 0.9929
 SynthDigits| Train Loss: 0.1042 | Train Acc: 0.9733
 MNIST-M    | Train Loss: 0.0896 | Train Acc: 0.9778
============ Test ============
 MNIST      | Test  Loss: 0.0891 | Test  Acc: 0.9722
 SVHN       | Test  Loss: 0.5134 | Test  Acc: 0.8463
 USPS       | Test  Loss: 0.1241 | Test  Acc: 0.9656
 SynthDigits| Test  Loss: 0.2808 | Test  Acc: 0.9138
 MNIST-M    | Test  Loss: 0.3515 | Test  Acc: 0.8881
============ Communication round 12 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0197 | Train Acc: 0.9964
 SVHN       | Train Loss: 0.2342 | Train Acc: 0.9307
 USPS       | Train Loss: 0.0221 | Train Acc: 0.9953
 SynthDigits| Train Loss: 0.0982 | Train Acc: 0.9761
 MNIST-M    | Train Loss: 0.0756 | Train Acc: 0.9830
============ Test ============
 MNIST      | Test  Loss: 0.0604 | Test  Acc: 0.9811
 SVHN       | Test  Loss: 0.5681 | Test  Acc: 0.8252
 USPS       | Test  Loss: 0.1273 | Test  Acc: 0.9636
 SynthDigits| Test  Loss: 0.2866 | Test  Acc: 0.9102
 MNIST-M    | Test  Loss: 0.3237 | Test  Acc: 0.8954
============ Communication round 13 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0241 | Train Acc: 0.9942
 SVHN       | Train Loss: 0.2172 | Train Acc: 0.9369
 USPS       | Train Loss: 0.0174 | Train Acc: 0.9962
 SynthDigits| Train Loss: 0.0822 | Train Acc: 0.9804
 MNIST-M    | Train Loss: 0.0669 | Train Acc: 0.9875
============ Test ============
 MNIST      | Test  Loss: 0.0725 | Test  Acc: 0.9775
 SVHN       | Test  Loss: 0.5566 | Test  Acc: 0.8331
 USPS       | Test  Loss: 0.1291 | Test  Acc: 0.9626
 SynthDigits| Test  Loss: 0.2974 | Test  Acc: 0.9051
 MNIST-M    | Test  Loss: 0.3260 | Test  Acc: 0.8964
============ Communication round 14 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0177 | Train Acc: 0.9959
 SVHN       | Train Loss: 0.1979 | Train Acc: 0.9466
 USPS       | Train Loss: 0.0194 | Train Acc: 0.9959
 SynthDigits| Train Loss: 0.0747 | Train Acc: 0.9811
 MNIST-M    | Train Loss: 0.0626 | Train Acc: 0.9878
============ Test ============
 MNIST      | Test  Loss: 0.0727 | Test  Acc: 0.9762
 SVHN       | Test  Loss: 0.4998 | Test  Acc: 0.8515
 USPS       | Test  Loss: 0.1275 | Test  Acc: 0.9636
 SynthDigits| Test  Loss: 0.2645 | Test  Acc: 0.9177
 MNIST-M    | Test  Loss: 0.3471 | Test  Acc: 0.8886
============ Communication round 15 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0149 | Train Acc: 0.9973
 SVHN       | Train Loss: 0.1732 | Train Acc: 0.9501
 USPS       | Train Loss: 0.0212 | Train Acc: 0.9951
 SynthDigits| Train Loss: 0.0604 | Train Acc: 0.9867
 MNIST-M    | Train Loss: 0.0516 | Train Acc: 0.9914
============ Test ============
 MNIST      | Test  Loss: 0.0591 | Test  Acc: 0.9807
 SVHN       | Test  Loss: 0.5227 | Test  Acc: 0.8448
 USPS       | Test  Loss: 0.1223 | Test  Acc: 0.9676
 SynthDigits| Test  Loss: 0.2611 | Test  Acc: 0.9167
 MNIST-M    | Test  Loss: 0.3468 | Test  Acc: 0.8878
============ Communication round 16 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0131 | Train Acc: 0.9974
 SVHN       | Train Loss: 0.1433 | Train Acc: 0.9649
 USPS       | Train Loss: 0.0164 | Train Acc: 0.9959
 SynthDigits| Train Loss: 0.0595 | Train Acc: 0.9871
 MNIST-M    | Train Loss: 0.0492 | Train Acc: 0.9901
============ Test ============
 MNIST      | Test  Loss: 0.0609 | Test  Acc: 0.9807
 SVHN       | Test  Loss: 0.5034 | Test  Acc: 0.8499
 USPS       | Test  Loss: 0.1234 | Test  Acc: 0.9671
 SynthDigits| Test  Loss: 0.2519 | Test  Acc: 0.9233
 MNIST-M    | Test  Loss: 0.3631 | Test  Acc: 0.8852
============ Communication round 17 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0100 | Train Acc: 0.9986
 SVHN       | Train Loss: 0.1388 | Train Acc: 0.9619
 USPS       | Train Loss: 0.0145 | Train Acc: 0.9973
 SynthDigits| Train Loss: 0.0521 | Train Acc: 0.9894
 MNIST-M    | Train Loss: 0.0383 | Train Acc: 0.9940
============ Test ============
 MNIST      | Test  Loss: 0.0567 | Test  Acc: 0.9814
 SVHN       | Test  Loss: 0.4949 | Test  Acc: 0.8544
 USPS       | Test  Loss: 0.1206 | Test  Acc: 0.9676
 SynthDigits| Test  Loss: 0.2412 | Test  Acc: 0.9236
 MNIST-M    | Test  Loss: 0.3357 | Test  Acc: 0.8943
============ Communication round 18 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0115 | Train Acc: 0.9978
 SVHN       | Train Loss: 0.1101 | Train Acc: 0.9727
 USPS       | Train Loss: 0.0103 | Train Acc: 0.9988
 SynthDigits| Train Loss: 0.0468 | Train Acc: 0.9890
 MNIST-M    | Train Loss: 0.0394 | Train Acc: 0.9936
============ Test ============
 MNIST      | Test  Loss: 0.0723 | Test  Acc: 0.9762
 SVHN       | Test  Loss: 0.4847 | Test  Acc: 0.8602
 USPS       | Test  Loss: 0.1175 | Test  Acc: 0.9661
 SynthDigits| Test  Loss: 0.2226 | Test  Acc: 0.9308
 MNIST-M    | Test  Loss: 0.3244 | Test  Acc: 0.8960
============ Communication round 19 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0086 | Train Acc: 0.9990
 SVHN       | Train Loss: 0.1103 | Train Acc: 0.9733
 USPS       | Train Loss: 0.0149 | Train Acc: 0.9960
 SynthDigits| Train Loss: 0.0456 | Train Acc: 0.9903
 MNIST-M    | Train Loss: 0.0343 | Train Acc: 0.9949
============ Test ============
 MNIST      | Test  Loss: 0.0527 | Test  Acc: 0.9827
 SVHN       | Test  Loss: 0.4789 | Test  Acc: 0.8589
 USPS       | Test  Loss: 0.1333 | Test  Acc: 0.9626
 SynthDigits| Test  Loss: 0.2336 | Test  Acc: 0.9272
 MNIST-M    | Test  Loss: 0.3110 | Test  Acc: 0.8997
============ Communication round 20 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0112 | Train Acc: 0.9977
 SVHN       | Train Loss: 0.0836 | Train Acc: 0.9815
 USPS       | Train Loss: 0.0152 | Train Acc: 0.9964
 SynthDigits| Train Loss: 0.0393 | Train Acc: 0.9914
 MNIST-M    | Train Loss: 0.0299 | Train Acc: 0.9957
============ Test ============
 MNIST      | Test  Loss: 0.0669 | Test  Acc: 0.9784
 SVHN       | Test  Loss: 0.4543 | Test  Acc: 0.8667
 USPS       | Test  Loss: 0.1169 | Test  Acc: 0.9671
 SynthDigits| Test  Loss: 0.2398 | Test  Acc: 0.9261
 MNIST-M    | Test  Loss: 0.3108 | Test  Acc: 0.9000
============ Communication round 21 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0097 | Train Acc: 0.9977
 SVHN       | Train Loss: 0.0893 | Train Acc: 0.9789
 USPS       | Train Loss: 0.0146 | Train Acc: 0.9963
 SynthDigits| Train Loss: 0.0316 | Train Acc: 0.9947
 MNIST-M    | Train Loss: 0.0302 | Train Acc: 0.9955
============ Test ============
 MNIST      | Test  Loss: 0.0461 | Test  Acc: 0.9851
 SVHN       | Test  Loss: 0.4491 | Test  Acc: 0.8690
 USPS       | Test  Loss: 0.1207 | Test  Acc: 0.9661
 SynthDigits| Test  Loss: 0.2240 | Test  Acc: 0.9326
 MNIST-M    | Test  Loss: 0.2953 | Test  Acc: 0.9052
============ Communication round 22 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0068 | Train Acc: 0.9990
 SVHN       | Train Loss: 0.0686 | Train Acc: 0.9852
 USPS       | Train Loss: 0.0084 | Train Acc: 0.9989
 SynthDigits| Train Loss: 0.0282 | Train Acc: 0.9963
 MNIST-M    | Train Loss: 0.0247 | Train Acc: 0.9970
============ Test ============
 MNIST      | Test  Loss: 0.0563 | Test  Acc: 0.9820
 SVHN       | Test  Loss: 0.4671 | Test  Acc: 0.8651
 USPS       | Test  Loss: 0.1194 | Test  Acc: 0.9661
 SynthDigits| Test  Loss: 0.2226 | Test  Acc: 0.9322
 MNIST-M    | Test  Loss: 0.2931 | Test  Acc: 0.9073
============ Communication round 23 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0065 | Train Acc: 0.9990
 SVHN       | Train Loss: 0.0586 | Train Acc: 0.9896
 USPS       | Train Loss: 0.0119 | Train Acc: 0.9974
 SynthDigits| Train Loss: 0.0327 | Train Acc: 0.9933
 MNIST-M    | Train Loss: 0.0218 | Train Acc: 0.9974
============ Test ============
 MNIST      | Test  Loss: 0.0467 | Test  Acc: 0.9849
 SVHN       | Test  Loss: 0.4379 | Test  Acc: 0.8738
 USPS       | Test  Loss: 0.1213 | Test  Acc: 0.9691
 SynthDigits| Test  Loss: 0.2237 | Test  Acc: 0.9307
 MNIST-M    | Test  Loss: 0.2956 | Test  Acc: 0.9061
============ Communication round 24 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0057 | Train Acc: 0.9993
 SVHN       | Train Loss: 0.0539 | Train Acc: 0.9893
 USPS       | Train Loss: 0.0076 | Train Acc: 0.9984
 SynthDigits| Train Loss: 0.0260 | Train Acc: 0.9957
 MNIST-M    | Train Loss: 0.0226 | Train Acc: 0.9960
============ Test ============
 MNIST      | Test  Loss: 0.0598 | Test  Acc: 0.9812
 SVHN       | Test  Loss: 0.4673 | Test  Acc: 0.8660
 USPS       | Test  Loss: 0.1119 | Test  Acc: 0.9711
 SynthDigits| Test  Loss: 0.2144 | Test  Acc: 0.9349
 MNIST-M    | Test  Loss: 0.3012 | Test  Acc: 0.9045
============ Communication round 25 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0058 | Train Acc: 0.9992
 SVHN       | Train Loss: 0.0404 | Train Acc: 0.9938
 USPS       | Train Loss: 0.0105 | Train Acc: 0.9979
 SynthDigits| Train Loss: 0.0239 | Train Acc: 0.9963
 MNIST-M    | Train Loss: 0.0171 | Train Acc: 0.9985
============ Test ============
 MNIST      | Test  Loss: 0.0452 | Test  Acc: 0.9861
 SVHN       | Test  Loss: 0.4633 | Test  Acc: 0.8697
 USPS       | Test  Loss: 0.1205 | Test  Acc: 0.9671
 SynthDigits| Test  Loss: 0.2211 | Test  Acc: 0.9322
 MNIST-M    | Test  Loss: 0.3053 | Test  Acc: 0.9004
============ Communication round 26 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0068 | Train Acc: 0.9985
 SVHN       | Train Loss: 0.0592 | Train Acc: 0.9863
 USPS       | Train Loss: 0.0084 | Train Acc: 0.9981
 SynthDigits| Train Loss: 0.0216 | Train Acc: 0.9963
 MNIST-M    | Train Loss: 0.0164 | Train Acc: 0.9988
============ Test ============
 MNIST      | Test  Loss: 0.0529 | Test  Acc: 0.9840
 SVHN       | Test  Loss: 0.4703 | Test  Acc: 0.8674
 USPS       | Test  Loss: 0.1106 | Test  Acc: 0.9716
 SynthDigits| Test  Loss: 0.2160 | Test  Acc: 0.9349
 MNIST-M    | Test  Loss: 0.2995 | Test  Acc: 0.9045
============ Communication round 27 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0034 | Train Acc: 1.0000
 SVHN       | Train Loss: 0.0380 | Train Acc: 0.9945
 USPS       | Train Loss: 0.0101 | Train Acc: 0.9981
 SynthDigits| Train Loss: 0.0210 | Train Acc: 0.9971
 MNIST-M    | Train Loss: 0.0163 | Train Acc: 0.9973
============ Test ============
 MNIST      | Test  Loss: 0.0469 | Test  Acc: 0.9864
 SVHN       | Test  Loss: 0.4788 | Test  Acc: 0.8661
 USPS       | Test  Loss: 0.1111 | Test  Acc: 0.9671
 SynthDigits| Test  Loss: 0.2161 | Test  Acc: 0.9351
 MNIST-M    | Test  Loss: 0.2879 | Test  Acc: 0.9076
============ Communication round 28 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0042 | Train Acc: 0.9993
 SVHN       | Train Loss: 0.0262 | Train Acc: 0.9973
 USPS       | Train Loss: 0.0082 | Train Acc: 0.9978
 SynthDigits| Train Loss: 0.0219 | Train Acc: 0.9964
 MNIST-M    | Train Loss: 0.0153 | Train Acc: 0.9988
============ Test ============
 MNIST      | Test  Loss: 0.0468 | Test  Acc: 0.9853
 SVHN       | Test  Loss: 0.4703 | Test  Acc: 0.8709
 USPS       | Test  Loss: 0.1112 | Test  Acc: 0.9696
 SynthDigits| Test  Loss: 0.1964 | Test  Acc: 0.9417
 MNIST-M    | Test  Loss: 0.2964 | Test  Acc: 0.9062
============ Communication round 29 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0031 | Train Acc: 1.0000
 SVHN       | Train Loss: 0.0332 | Train Acc: 0.9941
 USPS       | Train Loss: 0.0073 | Train Acc: 0.9986
 SynthDigits| Train Loss: 0.0217 | Train Acc: 0.9955
 MNIST-M    | Train Loss: 0.0100 | Train Acc: 0.9997
============ Test ============
 MNIST      | Test  Loss: 0.0394 | Test  Acc: 0.9877
 SVHN       | Test  Loss: 0.4630 | Test  Acc: 0.8714
 USPS       | Test  Loss: 0.1135 | Test  Acc: 0.9686
 SynthDigits| Test  Loss: 0.2142 | Test  Acc: 0.9356
 MNIST-M    | Test  Loss: 0.2939 | Test  Acc: 0.9083
============ Communication round 30 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0043 | Train Acc: 0.9995
 SVHN       | Train Loss: 0.0220 | Train Acc: 0.9975
 USPS       | Train Loss: 0.0056 | Train Acc: 0.9995
 SynthDigits| Train Loss: 0.0191 | Train Acc: 0.9967
 MNIST-M    | Train Loss: 0.0110 | Train Acc: 0.9992
============ Test ============
 MNIST      | Test  Loss: 0.0422 | Test  Acc: 0.9868
 SVHN       | Test  Loss: 0.4859 | Test  Acc: 0.8643
 USPS       | Test  Loss: 0.1133 | Test  Acc: 0.9686
 SynthDigits| Test  Loss: 0.2044 | Test  Acc: 0.9390
 MNIST-M    | Test  Loss: 0.2948 | Test  Acc: 0.9073
============ Communication round 31 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0023 | Train Acc: 1.0000
 SVHN       | Train Loss: 0.0188 | Train Acc: 0.9989
 USPS       | Train Loss: 0.0076 | Train Acc: 0.9982
 SynthDigits| Train Loss: 0.0156 | Train Acc: 0.9975
 MNIST-M    | Train Loss: 0.0103 | Train Acc: 0.9997
============ Test ============
 MNIST      | Test  Loss: 0.0431 | Test  Acc: 0.9871
 SVHN       | Test  Loss: 0.4784 | Test  Acc: 0.8682
 USPS       | Test  Loss: 0.1178 | Test  Acc: 0.9686
 SynthDigits| Test  Loss: 0.2009 | Test  Acc: 0.9398
 MNIST-M    | Test  Loss: 0.2755 | Test  Acc: 0.9111
============ Communication round 32 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0033 | Train Acc: 0.9997
 SVHN       | Train Loss: 0.0153 | Train Acc: 0.9996
 USPS       | Train Loss: 0.0066 | Train Acc: 0.9988
 SynthDigits| Train Loss: 0.0153 | Train Acc: 0.9975
 MNIST-M    | Train Loss: 0.0108 | Train Acc: 0.9995
============ Test ============
 MNIST      | Test  Loss: 0.0381 | Test  Acc: 0.9881
 SVHN       | Test  Loss: 0.4583 | Test  Acc: 0.8728
 USPS       | Test  Loss: 0.1172 | Test  Acc: 0.9676
 SynthDigits| Test  Loss: 0.2225 | Test  Acc: 0.9339
 MNIST-M    | Test  Loss: 0.2812 | Test  Acc: 0.9079
============ Communication round 33 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0026 | Train Acc: 0.9996
 SVHN       | Train Loss: 0.0307 | Train Acc: 0.9942
 USPS       | Train Loss: 0.0060 | Train Acc: 0.9988
 SynthDigits| Train Loss: 0.0112 | Train Acc: 0.9984
 MNIST-M    | Train Loss: 0.0117 | Train Acc: 0.9989
============ Test ============
 MNIST      | Test  Loss: 0.0428 | Test  Acc: 0.9862
 SVHN       | Test  Loss: 0.4732 | Test  Acc: 0.8675
 USPS       | Test  Loss: 0.1172 | Test  Acc: 0.9701
 SynthDigits| Test  Loss: 0.2032 | Test  Acc: 0.9392
 MNIST-M    | Test  Loss: 0.2927 | Test  Acc: 0.9077
============ Communication round 34 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0027 | Train Acc: 0.9999
 SVHN       | Train Loss: 0.0149 | Train Acc: 0.9992
 USPS       | Train Loss: 0.0059 | Train Acc: 0.9992
 SynthDigits| Train Loss: 0.0154 | Train Acc: 0.9973
 MNIST-M    | Train Loss: 0.0094 | Train Acc: 0.9989
============ Test ============
 MNIST      | Test  Loss: 0.0385 | Test  Acc: 0.9877
 SVHN       | Test  Loss: 0.4617 | Test  Acc: 0.8734
 USPS       | Test  Loss: 0.1148 | Test  Acc: 0.9686
 SynthDigits| Test  Loss: 0.2217 | Test  Acc: 0.9335
 MNIST-M    | Test  Loss: 0.2818 | Test  Acc: 0.9105
============ Communication round 35 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0027 | Train Acc: 0.9997
 SVHN       | Train Loss: 0.0108 | Train Acc: 0.9997
 USPS       | Train Loss: 0.0038 | Train Acc: 0.9999
 SynthDigits| Train Loss: 0.0121 | Train Acc: 0.9984
 MNIST-M    | Train Loss: 0.0086 | Train Acc: 0.9993
============ Test ============
 MNIST      | Test  Loss: 0.0401 | Test  Acc: 0.9880
 SVHN       | Test  Loss: 0.4619 | Test  Acc: 0.8742
 USPS       | Test  Loss: 0.1130 | Test  Acc: 0.9696
 SynthDigits| Test  Loss: 0.2043 | Test  Acc: 0.9381
 MNIST-M    | Test  Loss: 0.2782 | Test  Acc: 0.9109
============ Communication round 36 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0031 | Train Acc: 0.9996
 SVHN       | Train Loss: 0.0128 | Train Acc: 0.9993
 USPS       | Train Loss: 0.0033 | Train Acc: 0.9995
 SynthDigits| Train Loss: 0.0133 | Train Acc: 0.9982
 MNIST-M    | Train Loss: 0.0065 | Train Acc: 1.0000
============ Test ============
 MNIST      | Test  Loss: 0.0385 | Test  Acc: 0.9879
 SVHN       | Test  Loss: 0.4962 | Test  Acc: 0.8675
 USPS       | Test  Loss: 0.1125 | Test  Acc: 0.9676
 SynthDigits| Test  Loss: 0.2128 | Test  Acc: 0.9357
 MNIST-M    | Test  Loss: 0.2729 | Test  Acc: 0.9141
============ Communication round 37 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0024 | Train Acc: 0.9999
 SVHN       | Train Loss: 0.0144 | Train Acc: 0.9989
 USPS       | Train Loss: 0.0036 | Train Acc: 0.9996
 SynthDigits| Train Loss: 0.0147 | Train Acc: 0.9970
 MNIST-M    | Train Loss: 0.0126 | Train Acc: 0.9979
============ Test ============
 MNIST      | Test  Loss: 0.0389 | Test  Acc: 0.9883
 SVHN       | Test  Loss: 0.4828 | Test  Acc: 0.8712
 USPS       | Test  Loss: 0.1123 | Test  Acc: 0.9696
 SynthDigits| Test  Loss: 0.1858 | Test  Acc: 0.9456
 MNIST-M    | Test  Loss: 0.2912 | Test  Acc: 0.9095
============ Communication round 38 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0031 | Train Acc: 0.9999
 SVHN       | Train Loss: 0.0138 | Train Acc: 0.9988
 USPS       | Train Loss: 0.0081 | Train Acc: 0.9982
 SynthDigits| Train Loss: 0.0122 | Train Acc: 0.9981
 MNIST-M    | Train Loss: 0.0067 | Train Acc: 0.9996
============ Test ============
 MNIST      | Test  Loss: 0.0465 | Test  Acc: 0.9853
 SVHN       | Test  Loss: 0.4880 | Test  Acc: 0.8702
 USPS       | Test  Loss: 0.1123 | Test  Acc: 0.9696
 SynthDigits| Test  Loss: 0.2183 | Test  Acc: 0.9361
 MNIST-M    | Test  Loss: 0.2726 | Test  Acc: 0.9134
============ Communication round 39 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0024 | Train Acc: 0.9999
 SVHN       | Train Loss: 0.0118 | Train Acc: 0.9995
 USPS       | Train Loss: 0.0032 | Train Acc: 0.9997
 SynthDigits| Train Loss: 0.0077 | Train Acc: 0.9993
 MNIST-M    | Train Loss: 0.0073 | Train Acc: 0.9995
============ Test ============
 MNIST      | Test  Loss: 0.0381 | Test  Acc: 0.9889
 SVHN       | Test  Loss: 0.4648 | Test  Acc: 0.8764
 USPS       | Test  Loss: 0.1061 | Test  Acc: 0.9716
 SynthDigits| Test  Loss: 0.1903 | Test  Acc: 0.9421
 MNIST-M    | Test  Loss: 0.2822 | Test  Acc: 0.9117
============ Communication round 40 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0023 | Train Acc: 0.9999
 SVHN       | Train Loss: 0.0092 | Train Acc: 0.9996
 USPS       | Train Loss: 0.0030 | Train Acc: 0.9999
 SynthDigits| Train Loss: 0.0058 | Train Acc: 0.9997
 MNIST-M    | Train Loss: 0.0069 | Train Acc: 0.9995
============ Test ============
 MNIST      | Test  Loss: 0.0392 | Test  Acc: 0.9880
 SVHN       | Test  Loss: 0.4678 | Test  Acc: 0.8737
 USPS       | Test  Loss: 0.1062 | Test  Acc: 0.9741
 SynthDigits| Test  Loss: 0.1913 | Test  Acc: 0.9433
 MNIST-M    | Test  Loss: 0.2878 | Test  Acc: 0.9089
============ Communication round 41 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0044 | Train Acc: 0.9990
 SVHN       | Train Loss: 0.0086 | Train Acc: 0.9997
 USPS       | Train Loss: 0.0037 | Train Acc: 0.9993
 SynthDigits| Train Loss: 0.0076 | Train Acc: 0.9995
 MNIST-M    | Train Loss: 0.0056 | Train Acc: 0.9997
============ Test ============
 MNIST      | Test  Loss: 0.0468 | Test  Acc: 0.9854
 SVHN       | Test  Loss: 0.4822 | Test  Acc: 0.8726
 USPS       | Test  Loss: 0.1128 | Test  Acc: 0.9676
 SynthDigits| Test  Loss: 0.1953 | Test  Acc: 0.9424
 MNIST-M    | Test  Loss: 0.2662 | Test  Acc: 0.9147
============ Communication round 42 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0047 | Train Acc: 0.9988
 SVHN       | Train Loss: 0.0120 | Train Acc: 0.9990
 USPS       | Train Loss: 0.0110 | Train Acc: 0.9971
 SynthDigits| Train Loss: 0.0073 | Train Acc: 0.9992
 MNIST-M    | Train Loss: 0.0060 | Train Acc: 0.9995
============ Test ============
 MNIST      | Test  Loss: 0.0394 | Test  Acc: 0.9881
 SVHN       | Test  Loss: 0.4828 | Test  Acc: 0.8700
 USPS       | Test  Loss: 0.1228 | Test  Acc: 0.9646
 SynthDigits| Test  Loss: 0.1963 | Test  Acc: 0.9414
 MNIST-M    | Test  Loss: 0.2611 | Test  Acc: 0.9179
============ Communication round 43 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0015 | Train Acc: 1.0000
 SVHN       | Train Loss: 0.0075 | Train Acc: 0.9999
 USPS       | Train Loss: 0.0078 | Train Acc: 0.9978
 SynthDigits| Train Loss: 0.0085 | Train Acc: 0.9986
 MNIST-M    | Train Loss: 0.0062 | Train Acc: 0.9997
============ Test ============
 MNIST      | Test  Loss: 0.0390 | Test  Acc: 0.9878
 SVHN       | Test  Loss: 0.4766 | Test  Acc: 0.8747
 USPS       | Test  Loss: 0.1111 | Test  Acc: 0.9696
 SynthDigits| Test  Loss: 0.1938 | Test  Acc: 0.9437
 MNIST-M    | Test  Loss: 0.2722 | Test  Acc: 0.9140
============ Communication round 44 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0017 | Train Acc: 1.0000
 SVHN       | Train Loss: 0.0072 | Train Acc: 1.0000
 USPS       | Train Loss: 0.0026 | Train Acc: 0.9995
 SynthDigits| Train Loss: 0.0070 | Train Acc: 0.9990
 MNIST-M    | Train Loss: 0.0052 | Train Acc: 0.9999
============ Test ============
 MNIST      | Test  Loss: 0.0386 | Test  Acc: 0.9877
 SVHN       | Test  Loss: 0.4819 | Test  Acc: 0.8727
 USPS       | Test  Loss: 0.1194 | Test  Acc: 0.9676
 SynthDigits| Test  Loss: 0.1931 | Test  Acc: 0.9446
 MNIST-M    | Test  Loss: 0.2713 | Test  Acc: 0.9152
============ Communication round 45 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0015 | Train Acc: 1.0000
 SVHN       | Train Loss: 0.0072 | Train Acc: 1.0000
 USPS       | Train Loss: 0.0036 | Train Acc: 0.9993
 SynthDigits| Train Loss: 0.0069 | Train Acc: 0.9995
 MNIST-M    | Train Loss: 0.0059 | Train Acc: 0.9995
============ Test ============
 MNIST      | Test  Loss: 0.0400 | Test  Acc: 0.9876
 SVHN       | Test  Loss: 0.4796 | Test  Acc: 0.8732
 USPS       | Test  Loss: 0.1113 | Test  Acc: 0.9691
 SynthDigits| Test  Loss: 0.2157 | Test  Acc: 0.9358
 MNIST-M    | Test  Loss: 0.2993 | Test  Acc: 0.9076
============ Communication round 46 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0014 | Train Acc: 1.0000
 SVHN       | Train Loss: 0.0204 | Train Acc: 0.9967
 USPS       | Train Loss: 0.0022 | Train Acc: 0.9999
 SynthDigits| Train Loss: 0.0059 | Train Acc: 0.9995
 MNIST-M    | Train Loss: 0.0063 | Train Acc: 0.9993
============ Test ============
 MNIST      | Test  Loss: 0.0359 | Test  Acc: 0.9893
 SVHN       | Test  Loss: 0.4942 | Test  Acc: 0.8690
 USPS       | Test  Loss: 0.1155 | Test  Acc: 0.9681
 SynthDigits| Test  Loss: 0.1988 | Test  Acc: 0.9418
 MNIST-M    | Test  Loss: 0.2729 | Test  Acc: 0.9143
============ Communication round 47 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0011 | Train Acc: 1.0000
 SVHN       | Train Loss: 0.0063 | Train Acc: 0.9996
 USPS       | Train Loss: 0.0035 | Train Acc: 0.9995
 SynthDigits| Train Loss: 0.0048 | Train Acc: 0.9997
 MNIST-M    | Train Loss: 0.0071 | Train Acc: 0.9992
============ Test ============
 MNIST      | Test  Loss: 0.0345 | Test  Acc: 0.9899
 SVHN       | Test  Loss: 0.4685 | Test  Acc: 0.8744
 USPS       | Test  Loss: 0.1105 | Test  Acc: 0.9696
 SynthDigits| Test  Loss: 0.1944 | Test  Acc: 0.9431
 MNIST-M    | Test  Loss: 0.2833 | Test  Acc: 0.9126
============ Communication round 48 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0013 | Train Acc: 1.0000
 SVHN       | Train Loss: 0.0099 | Train Acc: 0.9993
 USPS       | Train Loss: 0.0023 | Train Acc: 0.9999
 SynthDigits| Train Loss: 0.0058 | Train Acc: 0.9996
 MNIST-M    | Train Loss: 0.0061 | Train Acc: 0.9996
============ Test ============
 MNIST      | Test  Loss: 0.0378 | Test  Acc: 0.9884
 SVHN       | Test  Loss: 0.4914 | Test  Acc: 0.8714
 USPS       | Test  Loss: 0.1179 | Test  Acc: 0.9661
 SynthDigits| Test  Loss: 0.1992 | Test  Acc: 0.9406
 MNIST-M    | Test  Loss: 0.2837 | Test  Acc: 0.9134
============ Communication round 49 ============
============ Train epoch 0 ============
 MNIST      | Train Loss: 0.0019 | Train Acc: 0.9999
 SVHN       | Train Loss: 0.0060 | Train Acc: 1.0000
 USPS       | Train Loss: 0.0027 | Train Acc: 0.9996
 SynthDigits| Train Loss: 0.0058 | Train Acc: 0.9996
 MNIST-M    | Train Loss: 0.0054 | Train Acc: 0.9999
============ Test ============
 MNIST      | Test  Loss: 0.0372 | Test  Acc: 0.9898
 SVHN       | Test  Loss: 0.4787 | Test  Acc: 0.8752
 USPS       | Test  Loss: 0.1148 | Test  Acc: 0.9701
 SynthDigits| Test  Loss: 0.1994 | Test  Acc: 0.9420
 MNIST-M    | Test  Loss: 0.2642 | Test  Acc: 0.9183
Traceback (most recent call last):
  File "/home/jiahui/miniconda3/lib/python3.9/site-packages/torch/serialization.py", line 380, in save
    _save(obj, opened_zipfile, pickle_module, pickle_protocol)
  File "/home/jiahui/miniconda3/lib/python3.9/site-packages/torch/serialization.py", line 604, in _save
    zip_file.write_record(name, storage.data_ptr(), num_bytes)
OSError: [Errno 28] No space left on device

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/jiahui/FL-NeurIPS-2022/Code/train/./fedbn.py", line 170, in <module>
    torch.save({
  File "/home/jiahui/miniconda3/lib/python3.9/site-packages/torch/serialization.py", line 381, in save
    return
  File "/home/jiahui/miniconda3/lib/python3.9/site-packages/torch/serialization.py", line 260, in __exit__
    self.file_like.write_end_of_file()
RuntimeError: [enforce fail at inline_container.cc:300] . unexpected pos 63262080 vs 63261976
terminate called after throwing an instance of 'c10::Error'
  what():  [enforce fail at inline_container.cc:300] . unexpected pos 63262080 vs 63261976
frame #0: c10::ThrowEnforceNotMet(char const*, int, char const*, std::string const&, void const*) + 0x47 (0x7fb5318a2d47 in /home/jiahui/miniconda3/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x23ea990 (0x7fb56650a990 in /home/jiahui/miniconda3/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #2: mz_zip_writer_add_mem_ex_v2 + 0x6d4 (0x7fb566505454 in /home/jiahui/miniconda3/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #3: caffe2::serialize::PyTorchStreamWriter::writeRecord(std::string const&, void const*, unsigned long, bool) + 0xb5 (0x7fb56650dbd5 in /home/jiahui/miniconda3/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #4: caffe2::serialize::PyTorchStreamWriter::writeEndOfFile() + 0x2c3 (0x7fb56650e0e3 in /home/jiahui/miniconda3/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #5: caffe2::serialize::PyTorchStreamWriter::~PyTorchStreamWriter() + 0x125 (0x7fb56650e395 in /home/jiahui/miniconda3/lib/python3.9/site-packages/torch/lib/libtorch_cpu.so)
frame #6: <unknown function> + 0x5103d3 (0x7fb5b4b0c3d3 in /home/jiahui/miniconda3/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
frame #7: <unknown function> + 0x1e3536 (0x7fb5b47df536 in /home/jiahui/miniconda3/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x1e4afe (0x7fb5b47e0afe in /home/jiahui/miniconda3/lib/python3.9/site-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #18: __libc_start_main + 0xf5 (0x7fb5ed63c555 in /lib64/libc.so.6)

